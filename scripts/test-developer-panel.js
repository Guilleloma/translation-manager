#!/usr/bin/env node

/**
 * Script de prueba para el panel de developer
 * Valida la detecciÃ³n de slugs auto-generados y la generaciÃ³n de sugerencias
 */

const { testCases, expectedSuggestions, isSlugAutoGenerated, generateSuggestedSlug } = require('../src/app/developer/test-data.ts');

console.log('ğŸ§ª Ejecutando pruebas del Panel de Developer\n');

// Test 1: Validar detecciÃ³n de slugs auto-generados
console.log('ğŸ“‹ Test 1: DetecciÃ³n de slugs auto-generados');
let passedTests = 0;
let totalTests = testCases.length;

testCases.forEach((testCase, index) => {
  const result = isSlugAutoGenerated(testCase.slug, testCase.text);
  const passed = result === testCase.expected;
  
  console.log(`  ${passed ? 'âœ…' : 'âŒ'} Test ${index + 1}: ${testCase.description}`);
  console.log(`     Slug: "${testCase.slug}" â†’ ${result ? 'Auto-generado' : 'VÃ¡lido'}`);
  
  if (passed) {
    passedTests++;
  } else {
    console.log(`     âŒ Esperado: ${testCase.expected}, Obtenido: ${result}`);
  }
});

console.log(`\nğŸ“Š Resultado Test 1: ${passedTests}/${totalTests} pruebas pasaron\n`);

// Test 2: Validar generaciÃ³n de sugerencias
console.log('ğŸ“‹ Test 2: GeneraciÃ³n de sugerencias de slug');
let passedSuggestions = 0;
let totalSuggestions = expectedSuggestions.length;

expectedSuggestions.forEach((testCase, index) => {
  const result = generateSuggestedSlug(testCase.text);
  const passed = result === testCase.expected;
  
  console.log(`  ${passed ? 'âœ…' : 'âŒ'} Sugerencia ${index + 1}:`);
  console.log(`     Texto: "${testCase.text}"`);
  console.log(`     Sugerencia: "${result}"`);
  
  if (passed) {
    passedSuggestions++;
  } else {
    console.log(`     âŒ Esperado: "${testCase.expected}", Obtenido: "${result}"`);
  }
});

console.log(`\nğŸ“Š Resultado Test 2: ${passedSuggestions}/${totalSuggestions} sugerencias correctas\n`);

// Resumen final
const totalPassed = passedTests + passedSuggestions;
const totalTotal = totalTests + totalSuggestions;

console.log('ğŸ¯ RESUMEN FINAL:');
console.log(`   Total de pruebas: ${totalTotal}`);
console.log(`   Pruebas exitosas: ${totalPassed}`);
console.log(`   Tasa de Ã©xito: ${Math.round((totalPassed / totalTotal) * 100)}%`);

if (totalPassed === totalTotal) {
  console.log('\nğŸ‰ Â¡Todas las pruebas pasaron! El panel de developer estÃ¡ listo.');
  process.exit(0);
} else {
  console.log('\nâš ï¸  Algunas pruebas fallaron. Revisar la implementaciÃ³n.');
  process.exit(1);
}
